<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Library | The Gopal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#f4f4ff" id="meta-theme-color" />
  <link rel="icon" href="favicon.ico" />

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- =========================
       HEADER
       ========================= -->
  <header class="header">
    <div class="logo-area">
      <div class="logo-circle">ðŸ“š</div>
      <div class="logo-text">
        <h1 class="site-title">Library</h1>
        <p class="site-subtitle">Search &amp; explore books</p>
      </div>
    </div>

    <div class="header-actions">
      <!-- You can repurpose this button later if you want -->
      <button
        id="themeToggle"
        class="icon-btn"
        type="button"
        aria-label="Theme"
      >
        <i class="fa-solid fa-sun"></i>
      </button>
    </div>
  </header>

  <!-- =========================
       MAIN CONTENT
       ========================= -->
  <main>
    <!-- TOP CONTROLS: search, chips, sort, stats -->
    <section class="top-controls" aria-label="Search and filters">
      <!-- Search -->
      <div class="search-container">
        <div class="search-bar">
          <i class="fa-solid fa-search"></i>
          <input
            id="searchInput"
            type="search"
            placeholder="Search by title, author, tag..."
            autocomplete="off"
          />
          <button
            id="searchClearBtn"
            class="icon-btn"
            type="button"
            aria-label="Clear search"
          >
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <button
          id="advancedSearchBtn"
          class="btn-outline"
          type="button"
        >
          <i class="fa-solid fa-sliders"></i>
          Advanced
        </button>
      </div>

      <!-- Categories row (ALL categories will be rendered here by JS) -->
      <div class="chip-row" aria-label="Categories">
        <!-- JS will populate: All + each category-chip -->
      </div>

      <!-- Stats + Sort -->
      <div class="meta-row">
        <div class="stats">
          <span id="totalBooksCount">0</span> books Â·
          <span id="visibleBooksCount">0</span> showing
        </div>
        <div class="sort-controls">
          <label for="sortSelect">
            Sort by
            <select id="sortSelect">
              <option value="title-asc">Title (Aâ€“Z)</option>
              <option value="title-desc">Title (Zâ€“A)</option>
              <option value="author-asc">Author (Aâ€“Z)</option>
              <option value="author-desc">Author (Zâ€“A)</option>
              <option value="size-asc">File size (smallâ€“big)</option>
              <option value="size-desc">File size (bigâ€“small)</option>
              <option value="pages-asc">Pages (fewâ€“many)</option>
              <option value="pages-desc">Pages (manyâ€“few)</option>
            </select>
          </label>
        </div>
      </div>
    </section>

    <!-- BOOKS GRID -->
    <section id="booksSection" aria-label="Books">
      <div
        id="booksGrid"
        class="books-grid"
        aria-live="polite"
        aria-busy="true"
      ></div>

      <!-- Empty state -->
      <div id="emptyState" class="empty-state" hidden>
        <p>No books found matching your filters.</p>
        <button id="resetFiltersBtn" class="btn-outline" type="button">
          Reset filters
        </button>
      </div>

      <!-- Pagination -->
      <div class="pagination" id="pagination"></div>
    </section>
  </main>

  <!-- =========================
       BOOK DETAIL MODAL
       ========================= -->
  <div
    id="bookModal"
    class="modal"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
    aria-labelledby="bookModalTitle"
  >
    <div class="modal-overlay" data-modal-close="bookModal"></div>
    <div class="modal-dialog">
      <button
        class="modal-close"
        type="button"
        data-modal-close="bookModal"
        aria-label="Close"
      >
        &times;
      </button>

      <div class="book-modal-content">
        <div class="book-modal-header">
          <img
            id="modalBookCover"
            class="book-cover-lg"
            src=""
            alt=""
          />
          <div class="book-modal-header-text">
            <h2 id="modalBookTitle"></h2>
            <p id="modalBookAuthor" class="book-author"></p>
            <div id="modalBookMeta" class="book-meta"></div>
          </div>
        </div>

        <p id="modalBookDescription" class="book-description"></p>

        <!-- extra details from sheet -->
        <p id="modalDetailsLine" class="modal-details-line"></p>

        <div id="modalBookTags" class="tags-row"></div>

        <div class="modal-footer">
          <!-- Get PDF button (left) -->
          <button
            id="modalPdfBtn"
            type="button"
            class="btn modal-pdf-btn"
          >
            <i class="fa-solid fa-file-pdf"></i>
            <span>Get PDF</span>
          </button>

          <!-- Bookmark button -->
          <button
            id="modalBookmarkBtn"
            type="button"
            class="btn"
          >
            <i class="fa-regular fa-bookmark"></i>
            <span>Bookmark</span>
          </button>

          <!-- Close button -->
          <button
            id="modalCloseBtn"
            class="btn-outline"
            type="button"
            data-modal-close="bookModal"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================
       CATEGORIES MODAL (optional full list)
       ========================= -->
  <div
    id="categoriesModal"
    class="modal"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
    aria-labelledby="categoriesModalTitle"
  >
    <div class="modal-overlay" data-modal-close="categoriesModal"></div>
    <div class="modal-dialog">
      <button
        class="modal-close"
        type="button"
        data-modal-close="categoriesModal"
        aria-label="Close"
      >
        &times;
      </button>

      <h2 id="categoriesModalTitle">Browse by category</h2>
      <div id="categoriesList" class="categories-list">
        <!-- JS will render all categories here as .category-chip buttons -->
      </div>
    </div>
  </div>

  <!-- =========================
       ADVANCED SEARCH MODAL
       ========================= -->
  <div
    id="searchOverlay"
    class="modal"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
    aria-labelledby="searchOverlayTitle"
  >
    <div class="modal-overlay" data-modal-close="searchOverlay"></div>
    <div class="modal-dialog">
      <button
        class="modal-close"
        type="button"
        data-modal-close="searchOverlay"
        aria-label="Close"
      >
        &times;
      </button>

      <h2 id="searchOverlayTitle">Advanced search</h2>

      <form id="advancedSearchForm" class="advanced-search-form">
        <label>
          Title
          <input
            id="advTitleInput"
            type="text"
            placeholder="Book title"
          />
        </label>

        <label>
          Author
          <input
            id="advAuthorInput"
            type="text"
            placeholder="Author name"
          />
        </label>

        <label>
          Tags
          <input
            id="advTagsInput"
            type="text"
            placeholder="e.g. PDF,10 MB,150 PAGES"
          />
        </label>

        <label>
          Category
          <input
            id="advCategoryInput"
            type="text"
            placeholder="Category"
          />
        </label>

        <div class="advanced-search-actions">
          <button type="submit" class="btn">
            Apply filters
          </button>
          <button
            id="advancedSearchResetBtn"
            type="button"
            class="btn-outline"
          >
            Reset
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- =========================
       BOTTOM NAV (MOBILE)
       ========================= -->
  <nav class="bottom-nav" aria-label="Primary navigation">
    <ul>
      <li>
        <button
          type="button"
          id="navHomeBtn"
          aria-label="All books"
          class="active"
        >
          <i class="fa-solid fa-book"></i>
        </button>
      </li>
      <li>
        <button
          type="button"
          id="navSearchBtn"
          aria-label="Search"
        >
          <i class="fa-solid fa-search"></i>
        </button>
      </li>
      <li>
        <button
          type="button"
          id="navBookmarksBtn"
          aria-label="Bookmarks"
        >
          <i class="fa-regular fa-bookmark"></i>
        </button>
      </li>
      <li>
        <button
          type="button"
          id="navCategoriesBtn"
          aria-label="Categories"
        >
          <i class="fa-solid fa-grid-2"></i>
        </button>
      </li>
    </ul>
  </nav>

  <!-- =========================
       SCRIPTS
       ========================= -->
  <script src="js/app.js" defer></script>
  <script>
    // Basic service worker registration
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", function () {
        navigator.serviceWorker
          .register("/sw.js")
          .catch(function (err) {
            console.error("SW registration failed:", err);
          });
      });
    }
  </script>
</body>
</html>
